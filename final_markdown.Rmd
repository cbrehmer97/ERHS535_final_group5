---
title: "Final"
author: "Nikki Johnson"
date: "11/13/2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, messages = FALSE)
```

***

## Load in Data

```{r Load Data}
library(readr)

jeopardy <- read_tsv("data/master_season1-35.tsv")
<<<<<<< HEAD

## Filtering to ONLY look at Round 1
clean_data <- jeopardy %>% 
  filter(round == "1") %>% 
  mutate(air_date = ymd(air_date))

## Filtering to ONLY have the episodes where the entire board was asked. 
perfect_round <- clean_data %>% 
  group_by(air_date) %>% 
  summarise(total_questions_asked = n()) %>% 
  filter(total_questions_asked == "30")

## Based on the position the questions are asked in the list, creating a column 
## that has the category position, and the value of the question
labeling_positions <- clean_data %>% 
  right_join(perfect_round, by = c("air_date")) %>% 
  group_by(air_date) %>% 
  mutate(category_number =  c("Category 1", "Category 1", "Category 1", 
                              "Category 1", "Category 1", 
                              "Category 2", "Category 2", "Category 2", 
                              "Category 2", "Category 2",
                              "Category 3", "Category 3", "Category 3", 
                              "Category 3", "Category 3", 
                              "Category 4", "Category 4", "Category 4", 
                              "Category 4", "Category 4", 
                              "Category 5", "Category 5", "Category 5", 
                              "Category 5", "Category 5",
                              "Category 6", "Category 6", "Category 6", 
                              "Category 6", "Category 6"),
          value_number = c("100", "200", "300", "400", "500", 
                           "100", "200", "300", "400", "500",
                           "100", "200", "300", "400", "500", 
                           "100", "200", "300", "400", "500",
                           "100", "200", "300", "400", "500", 
                           "100", "200", "300", "400", "500")) %>% 
  mutate(daily_double = as.factor(daily_double),
         daily_double = fct_recode(daily_double,
                               "0" = "no",
                               "1" = "yes"),
         daily_double = as.character(daily_double))

## Finding the number of daily doubles by category and value
daily_double_positions <- labeling_positions %>% 
  mutate(daily_double = as.numeric(daily_double),
         year = year(air_date)) %>% 
  group_by(category_number, value_number, year) %>%
  summarise(number_of_doubles = sum(daily_double)) %>% 
  ungroup() %>% 
  mutate(value_number = as.numeric(value_number),
         number_of_doubles = as.numeric(number_of_doubles))
```


```{r Heat Map with ggplot2}
library(ggplot2)

daily_double_positions %>% 
  ggplot(aes(x = category_number, y = value_number, fill = number_of_doubles )) +
  geom_tile(color = "White", size = 0.1)


```

```{r Heat map with ggplot2 animated}
library(purrr)
make_plot <- function(Yr){
  ggplot(data = daily_double_positions, aes(x = category_number, y = value_number, fill = number_of_doubles)) +
    geom_tile(color = "white", size = 0.1)
}

seq(from = 1984, to = 2015, by = 1) %>% 
  map_df(make_plot)
```


```{r Heat Map with plotly}
library(plotly)

daily_double_positions %>% 
  plot_ly(
    x = ~ category_number,
    y = ~ value_number,
    color = ~ number_of_doubles,
    frame = ~ year,
    type = 'heatmap'
  )

```





=======
```

***
>>>>>>> aece1129bb053f074c094d47ebe95f97bb58871a
